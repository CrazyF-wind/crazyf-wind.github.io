<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="code">
<meta name="keywords" content="blog">
<meta property="og:type" content="website">
<meta property="og:title" content="fwind&#39;s blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="fwind&#39;s blog">
<meta property="og:description" content="code">
<meta property="og:locale" content="zh">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="fwind&#39;s blog">
<meta name="twitter:description" content="code">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>fwind's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">fwind's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">coder</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/14/Node-js-下使用-gm-模块的一些思考/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fwind">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fwind's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/14/Node-js-下使用-gm-模块的一些思考/" itemprop="url"> Node.js 下使用 gm 模块的一些思考</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-14T15:20:06+08:00">
                2019-11-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="@aman-dhakal-YkWz_coLm84-unsplash.jpg" alt></p>
<blockquote>
<p> 楔子  </p>
</blockquote>
<p>在早些年开发 Node.js 项目的过程中，我使用过其子进程（child_process）模块的部分功能，当时需要在 Node.js 的程序中使用 Linux 下的一个命令来处理一些数据。比如实现一个使用 ls 命令来查看当前目录结构的功能：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这是 Node.js 官方版本 12.x 文档下提供的一个实现例子 [Child Process | Node.js v12.13.0 Documentation](https://nodejs.org/dist/latest-v12.x/docs/api/child_process.html#child_process_child_process_spawn_command_args_options)</span></span><br><span class="line"><span class="keyword">const</span> &#123; spawn &#125; = <span class="built_in">require</span>(‘child_process’);</span><br><span class="line"><span class="keyword">const</span> ls = spawn(‘ls’, [‘-lh’, ‘/Users’]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 控制台正常输出</span></span><br><span class="line">ls.stdout.on(‘data’, (data) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`stdout: <span class="subst">$&#123;data&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 控制台异常输出</span></span><br><span class="line">ls.stderr.on(<span class="string">'data'</span>, (data) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.error(<span class="string">`stderr: <span class="subst">$&#123;data&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 关闭</span></span><br><span class="line">ls.on(<span class="string">'close'</span>, (code) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`child process exited with code <span class="subst">$&#123;code&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>事实上，我们可以通过以上方式，来实现任何与本地 Linux 服务交互的工作。任何 Linux 服务器下的系统命令，或者安装的第三方软件，均可以通过 Node.js 来使用。</p>
<blockquote>
<p>达摩克利斯之剑  </p>
</blockquote>
<p>当时只是觉得这个功能好玩、实用，但是没有进一步深入研究。直到 <a href="https://mp.weixin.qq.com/s/j_U6vQRu360iXwieG33DBA" target="_blank" rel="noopener">周下载量过 200万的 npm 包被注入恶意代码 </a> 事件的发生，让我意识到 Node.js 的子进程功能还是一把达摩克利斯之剑。在安全防范较低或者没有的情况下，极其容易被恶意利用，而且后果不堪设想。</p>
<p>当然，该事件当中还藏着另外一把达摩克利斯之剑：JavaScript 下的 eval 函数 。eval 函数中可以执行几乎所有的 JavaScript 代码，简直就是一个行走的编译器。在使用该函数时，同样需要做好相关的安全工作，比如限制未知用户往里面传入任何数据。</p>
<p>当然，事件热的时候，关注过，凉了之后也就不了了之。</p>
<blockquote>
<p>又见，思考  </p>
</blockquote>
<p>直到最近一段时间，在做一个项目，需要对图像文件做一下处理。在 Linux/Mac 下有一个图形图像处理工具，叫  imagemagick ，里面有瑞士军刀般多的好用功能。下意识中，我就想到了使用 Node.js 的子进程功能来直接使用。但是我又觉得这么实现似乎过于简单，而且太依赖本地环境。</p>
<p>于是，我就去 Node.js 官网查找了一下，看有没有新增处理图形图像的新特性，很遗憾，并没有！但是我并没死心，又继续在 bing 中搜索了一下。这时我找到一片文章（<a href="https://blog.csdn.net/dreamer2020/article/details/51647885" target="_blank" rel="noopener">nodejs图片处理工具gm用法</a>），介绍了如何在 Node.js 环境下，使用 npm 包 gm 来处理图形图像文件。</p>
<p>我很高兴，并认为这是一个理想的方案，因为那篇文中关于 gm 的介绍十分清楚，并且使用起来也很简洁。在甚至连 gm 在 npm 官网上的使用手册都没有看的前提下，我就贸然使用了 gm 。</p>
<p>当我激动地盯着屏幕，看着那段脚本启动，然后报异常后，我的心情先是失落，然后转为意外，最后，我静静地笑了。因为异常提示没有找到 convert 命令，而 convert 命令正是我上面提到 imagemagick 工具一下的一个命令。所以我推测这个 gm 包其实就是按照我最初的那种思路实现的。</p>
<p>为了一探究竟并验证我的想法。首先，我看了 gm 在 npm 上的官方使用手册。果然，文档的一开始就清楚的提示，使用该工具之前需要先安装 imagemagick 。那它到底是如何使用的 imagemagick 呢？让我们接着往下看。 </p>
<p>我看了 gm 的源码。果然， gm 引用了一个叫 cross-spawn 的包，来执行 convert 命令，而 cross-spawn 的源码中，确实是使用 child_process 子进程来实现的。</p>
<p>到此为止，整个过程已经理顺。而我则陷入了沉思……</p>
<p>可想而知，利用这种模式，即 Node.js + child_process 的方式，可以实现很多基于操作系统命令行的功能。在没有遇到 gm 之前，我只是简单地这么认为。在遇到 gm 之后，我才发现，原来真的有工程师利用这种模式来输出被广泛（ gm 在 npm 上的周下载量，截止我写这篇文章为止，已经超 10 万了）使用的工具。有时候，编程技术迭代很快，日新月异，每隔一段时间就会有一个新的很炫酷的技术冒出来，然后受到大家的追捧。而有时候，编程技术迭代又很慢，很多技术明明是新瓶装旧酒，却同样可以焕发出耀眼的光芒。</p>
<p>所以说，在计算机这一行，如果你真心的热爱她，就应该沉下心来，认真地去理解和感悟技术的本质，而不是去一个劲儿地追逐新时髦。唯有看透本质，才是获取真理钥匙的最佳途径。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/07/npm-中-dependencies-和-devDependencies-的使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fwind">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fwind's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/07/npm-中-dependencies-和-devDependencies-的使用/" itemprop="url"> npm 中 dependencies 和 devDependencies 的使用 </a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-07T16:51:08+08:00">
                2019-11-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="@luca-bravo-rnBzqZ8bgAY-unsplash.jpg" alt></p>
<blockquote>
<p>导读  </p>
</blockquote>
<p>使用 npm 作为包管理工具已经很多年了，但是常用的其实就那么几个功能，一些基础的但很重要的概念和用法反而不太清楚。最近抽空整理并探索一下，重新学习 npm 。</p>
<p>今天先对 package.json 配置文件中的 dependencies 和 devDependencies 做一番研究。</p>
<h2 id="dependencies"><a href="#dependencies" class="headerlink" title="dependencies"></a>dependencies</h2><ol>
<li>使用环境：生产环境下所依赖的 npm 包集合；</li>
<li><p>命令行安装单个包的方式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在与 package.json 同级目录下执行</span></span><br><span class="line"><span class="comment"># —sava-prod 为默认安装模式</span></span><br><span class="line"><span class="comment"># 安装以后会自动在 package.json 的 dependencies 下添加 &lt;package-name&gt;</span></span><br><span class="line">npm install &lt;package-name&gt; [—sava-prod]</span><br></pre></td></tr></table></figure>
</li>
<li><p>命令行集成安装方式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在与 package.json 同级目录下执行</span></span><br><span class="line"><span class="comment"># 安装 dependencies 和 devDependencies 中的所有 npm 包</span></span><br><span class="line">npm install</span><br><span class="line"><span class="comment"># 仅安装 dependencies 下的所有 npm 包</span></span><br><span class="line">npm install —production</span><br></pre></td></tr></table></figure>
</li>
<li><p>被调用：如果将当前工程作为一个单独包，提供给其他人使用，在对方使用 npm install 命令安装时，会自动下载 dependencies 下的包集合。</p>
</li>
</ol>
<h2 id="devDependencies"><a href="#devDependencies" class="headerlink" title="devDependencies"></a>devDependencies</h2><ol>
<li>使用环境：开发和测试环境下所依赖的 npm 包集合；</li>
<li><p>命令行安装单个包的方式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在与 package.json 同级目录下执行</span></span><br><span class="line"><span class="comment"># 安装以后会自动在 package.json 的 devDependencies 下添加 &lt;package-name&gt;</span></span><br><span class="line">npm install &lt;package-name&gt; —sava-dev</span><br></pre></td></tr></table></figure>
</li>
<li><p>命令行集成安装方式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在与 package.json 同级目录下执行</span></span><br><span class="line"><span class="comment"># 安装 dependencies 和 devDependencies 中的所有 npm 包</span></span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>
</li>
<li><p>被调用：如果将当前工程作为一个单独包，提供给其他人使用，在对方使用 npm install 命令安装时，不会自动下载 devDependencies 下的包集合。</p>
</li>
</ol>
<h2 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h2><h3 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h3><p>在我以往写代码的过程中，对于需要引用包的位置，并没有做任何区分，因为在使用 npm install 时会一起安装，所以没有太在意，直到使用 nest.js 时发现，默认安装的包居然有 200M 之多。</p>
<p>当我需要自动化部署它们到一台线上服务器时，会花费很多时间，但其实像 @nestjs/cli 、 @types/supertest 等开发和测试工具在线上根本是用不着的。</p>
<p>于是我对于要往线上环境上传的工程使用了 npm install —production 命令，这时文件大小缩小为 11M ，然后再压缩以后，最终仅仅剩下了 5M 。</p>
<h3 id="发布"><a href="#发布" class="headerlink" title="发布"></a>发布</h3><p>当整个工程开发完毕，作为一个独立包待发布时，同样需要注意！如果不对 dependencies 和 devDependencies 加以区分，将开发/测试依赖写在生产依赖下，会导致调用该 npm 包的用户下载很多与其无关的包，从而造成不必要的资源浪费。</p>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><p><a href="https://docs.npmjs.com/specifying-dependencies-and-devdependencies-in-a-package-json-file" target="_blank" rel="noopener">Specifying dependencies and devDependencies in a package.json file |                 npm Documentation</a><br><a href="https://blog.csdn.net/csdn_yudong/article/details/83721870" target="_blank" rel="noopener">npm install 你很明白吗 - NeverYu - CSDN博客</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/01/记一次在github上提交issue的经历/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fwind">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fwind's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/01/记一次在github上提交issue的经历/" itemprop="url">记一次在 github 上提交 issue 的经历</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-01T16:33:37+08:00">
                2019-11-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="pixelperfektion-Gnf4gANJvko-unsplash.jpg" alt></p>
<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>在一次使用 vs code 时，发现一个 bug ：使用中文路径 split terminal （终端分屏）时会报异常并且失败，英文路径是ok的。</p>
<h2 id="经过"><a href="#经过" class="headerlink" title="经过"></a>经过</h2><h3 id="确认-bug"><a href="#确认-bug" class="headerlink" title="确认 bug"></a>确认 bug</h3><p>然后我在不同场景下试图复现这个 bug ：</p>
<ol>
<li>使用 vs code 新建一个工程，然后新建中文目录， bug 会 100% 复现；</li>
<li>在 vs code 中选择不同 shell ， bash 和 zsh ， bug 仍旧 100% 复现；</li>
<li>因为vs code的终端是基于本地系统的，所以我在本地终端中，新建中文文件，然后基于该路径，使用终端软件自带分屏功能进行分屏，并没有出现 bug ，排除终端问题。</li>
</ol>
<h3 id="提交-bug"><a href="#提交-bug" class="headerlink" title="提交 bug"></a>提交 bug</h3><p>目前来看，这个应该是 vs code 的一个 bug，实锤了。因此我决定将这个 bug反馈给 vs code 的工作人员。</p>
<p>之前在使用 vs code 时，无意中发现右下角有个笑脸，是用来接收反馈信息的，于是乎我现在选择触发它。</p>
<p>触发以后，点击“提交 bug ”，会弹出一个界面，用于填写bug内容，这里需要使用英文编辑（如果是中文提问，工程师会告诉你他不会中文，并无情地关闭 issue ）。然后点击“在 github 预览”会跳转到 github 下（需要登录），此时如果不需要编辑，直接 submit issue 就好。</p>
<h3 id="来自工程师的响应"><a href="#来自工程师的响应" class="headerlink" title="来自工程师的响应"></a>来自工程师的响应</h3><p>在提交完 issue 以后的第二天早上，我收到了来自 vs code 工作人员的回复，一位来自澳大利亚的软件工程师，他告诉我提交该类型的 issue ，还需要提供一下我的 vs code 版本信息，最好还有 bug 复现的视频、动图或者截屏。</p>
<p>得到对方的及时回复（毕竟有时差），我还是有点小激动的。然后按照对方提示，我认真的准备了 vs code 版本信息和 bug 复现动图，并再一次提交。</p>
<p>这一次，在当天晚上我就得到了回复，对方提供了解决方案，修改 setting 配置，在分屏时自动返回到 vs code 工程的父路径。这样配置以后，中文路径分屏确实不报异常了，但是却修改了我原本的使用习惯。于是乎，我把这个情况再一次反馈回去。</p>
<p>这位来自澳大利亚的帅气工程师，这次是这么回复的：你提的问题我们后续会修复，之前告诉你的也只是当前的解决方案。简洁并且直爽，人家之所以给你提之前的方案，并不是说 bug 不存在，只是另一个解决方式，bug我们还是会改，但是你得等待。</p>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p>到此为止，我认为我的目的达到了，于是乎就把这个issue关了。但是没过多久，这个工程却重新打开了 issue 。我没有再追问，我推测在 bug 修复之前， issue 应该是不会关闭，具体是不是这个澳洲小伙修复就不得而知了。</p>
<p>关于这次issue的整个过程，在 github 上完成过程，感兴趣的同学可以自行查阅。（<a href="https://github.com/microsoft/vscode/issues/83496" target="_blank" rel="noopener">terminal.integrataed.splitCwd inherited doesn’t work correctly for unicode characters · Issue #83496 · microsoft/vscode · GitHub</a>）</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/10/Linux服务器守护进程方案及实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fwind">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fwind's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/10/Linux服务器守护进程方案及实现/" itemprop="url">Linux服务器守护进程方案及实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-10T17:26:31+08:00">
                2019-10-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="Linux服务器进程守护思路.jpg" alt></p>
<blockquote>
<p>总体思路  </p>
<ol>
<li>在linux服务器新建无登录账号（/sbin/nologin/）</li>
<li>构建自动化启动进程脚本</li>
<li>新建计划任务定时监控服务（crontab）</li>
</ol>
</blockquote>
<h2 id="初衷"><a href="#初衷" class="headerlink" title="初衷"></a>初衷</h2><p>在服务器的管理中，我们需要启动一些服务，出于安全方面的考虑，我们不希望以root的方式启动它，而是为这些服务单独建立相应的账号，并且禁用它们的shell登录权限。</p>
<h2 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h2><h3 id="场景说明"><a href="#场景说明" class="headerlink" title="场景说明"></a>场景说明</h3><p>在linux服务器上实现对于nodejs进程进行守护的场景。</p>
<h3 id="构建nodejs程序"><a href="#构建nodejs程序" class="headerlink" title="构建nodejs程序"></a>构建nodejs程序</h3><ol>
<li><p>我们新建一个nodejs程序server.js：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(‘http’)</span><br><span class="line"><span class="keyword">const</span> server = http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.writeHead(<span class="number">200</span>, &#123;</span><br><span class="line">        ‘Content-Type’: ‘application/json’</span><br><span class="line">    &#125;);</span><br><span class="line">    res.end(‘&#123;“server”:”nodejs”&#125;’);</span><br><span class="line">&#125;);</span><br><span class="line">server.listen(<span class="number">8080</span>)</span><br><span class="line"><span class="built_in">console</span>.log(“port = <span class="number">8080</span>”)</span><br></pre></td></tr></table></figure>
</li>
<li><p>常规启动：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node server.js</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>启动以后，server.js进程属于root用户，或者其他可以shell登录的用户：<br><img src="726223FE-043B-4807-8E96-82F553517F36.png" alt></p>
<ol start="3">
<li>在浏览器敲入ip加端口即可查看运行结果：<br><img src="04EDB1C0-7455-42D4-8141-C14059419131.png" alt></li>
</ol>
<h3 id="新建无登录账号"><a href="#新建无登录账号" class="headerlink" title="新建无登录账号"></a>新建无登录账号</h3><ol>
<li><p>新建账号：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -M -s /sbin/nologin nodejsUser</span><br></pre></td></tr></table></figure>
</li>
<li><p>在/etc/passwd下查看账号状态：<br><img src="1F2C7BA3-B386-43FC-AD9C-55AB2D45E8E7.png" alt><br>nodejsUser是无法shell登录的，我们可以使用如下命令启动server.js：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 赋予nodejsUser账号可访问server.js文件的权限</span></span><br><span class="line">sudo chown nodejsUser /opt/nodejsUser/server.js</span><br><span class="line"><span class="comment"># 启动</span></span><br><span class="line">sudo -u nodejsUser node /opt/nodejsUser/server.js</span><br></pre></td></tr></table></figure>
</li>
<li><p>此时查看8080端口，可以发现，现在用户是nodejsUser了：<br><img src="1AC51472-D033-4089-99C9-FD407A4ED153.png" alt></p>
</li>
</ol>
<h3 id="编写自动化启动脚本"><a href="#编写自动化启动脚本" class="headerlink" title="编写自动化启动脚本"></a>编写自动化启动脚本</h3><ol>
<li><p>此处我们需要借助tmux工具来实现实时监控nodejs进程的功能，下面是具体实现过程server.sh：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># tumx启动脚本</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 兼容zsh</span></span><br><span class="line"><span class="built_in">export</span> DISABLE_AUTO_TITLE=<span class="string">"true"</span></span><br><span class="line"><span class="comment"># 会话名称</span></span><br><span class="line">session=“sever”</span><br><span class="line"><span class="comment"># 判断server.js进程是否存在</span></span><br><span class="line">ps -ef|grep <span class="string">"node /opt/nodejsUser/server.js"</span> |grep -v grep</span><br><span class="line"><span class="keyword">if</span> [ $? -ne 0 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"start process....."</span></span><br><span class="line">	  <span class="comment"># 判断tmux会话是否存在</span></span><br><span class="line">    tmux has-session -t <span class="variable">$session</span></span><br><span class="line">    <span class="keyword">if</span> [ $? = 0 ]</span><br><span class="line">        <span class="keyword">then</span></span><br><span class="line">		  <span class="comment"># 如果存在，则进入该会话</span></span><br><span class="line">        tmux attach-session -t <span class="variable">$session</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">		  <span class="comment"># 如果不存在，则新建会话</span></span><br><span class="line">        tmux new-session -d -s <span class="variable">$session</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">	  <span class="comment"># 发送启动程序命令</span></span><br><span class="line">    tmux send-keys -t <span class="variable">$session</span> <span class="string">"sudo -u nodejsUser node /opt/nodejsUser/server.js"</span> C-m</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	  <span class="built_in">echo</span> <span class="string">"runing....."</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>当tmux会话启动以后，可以随时查看server.js运行的情况：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 	启动会话</span></span><br><span class="line">tmux a -t server</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="自定义计划任务"><a href="#自定义计划任务" class="headerlink" title="自定义计划任务"></a>自定义计划任务</h3><ol>
<li><p>新建计划任务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure>
</li>
<li><p>任务内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*/1 * * * * /bin/bash /opt/nodejsUser/server.sh &gt;&gt; /opt/nodejsUser/run.log 2&gt;&amp;1</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>每分钟执行一次server.sh脚本，执行情况记录到日志文件run.log当中。crontab的定时机制可以自行查阅，比较好理解，这里不再赘述。</p>
<h2 id="写在最后的话"><a href="#写在最后的话" class="headerlink" title="写在最后的话"></a>写在最后的话</h2><p>到此为止，所有功能均已实现，我们的计划任务会定时对server.js进程扫描，当发现该进程crash时，会自动重启。当服务器重启时，计划任务也会超常运行。</p>
<p>其实在这之前，我在管理nodejs项目时，使用的是pm2监控工具，现成的免费工具，用起来确实也比较方便，但是在无登录账号下遇到无法启动pm2的问题，虽然花了一些时间攻克，但最终并没有解决，因此就有了本文中的解决方案，先用一段时间看看效果吧。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/26/ES6函数简写及思考/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fwind">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fwind's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/26/ES6函数简写及思考/" itemprop="url">ES6函数简写及思考</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-26T16:49:09+08:00">
                2019-09-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="ES6函数简写及思考.jpg" alt></p>
<blockquote>
<p>初闻    </p>
</blockquote>
<p>一次，一个同事在群里问，有谁知道这个函数该如何用ES6的方式简写：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">n</span>)</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">m</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> m+n</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>我当时也没动脑子，直接按潜意识改了一下，发出去了：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fn=<span class="function">(<span class="params">n</span>)=&gt;</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="function">(<span class="params">m</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> m+n</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>果然，发code的那家伙神秘一笑，说你再继续简化一下试试。我后背一凉，赶紧又看了看，改成这个样子又抛出去了：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fn=<span class="function">(<span class="params">n</span>)=&gt;</span><span class="function">(<span class="params">m</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> m+n</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>我自认为这种总该差不多了吧，结果又被生生打脸。题主笑而不语，然后我恍然大悟，看来之前真是自以为会用，根本没有认真思考过，其实还可以进一步简化：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fn=<span class="function">(<span class="params">n</span>)=&gt;</span><span class="function">(<span class="params">m</span>)=&gt;</span> m+n</span><br></pre></td></tr></table></figure></p>
<p>最后题主说，把括弧也去了吧：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fn = <span class="function"><span class="params">n</span> =&gt;</span> m =&gt; m + n</span><br></pre></td></tr></table></figure></p>
<p>看着这段code，我沉默了……原来code可以如此简洁、优美、易懂。</p>
<blockquote>
<p>偶遇    </p>
</blockquote>
<p>上面的故事发生没多久以后，我在看一个帖子时，发现如下code：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [</span><br><span class="line">            &#123; <span class="attr">name</span>:<span class="string">"小明"</span>, <span class="attr">age</span>:<span class="number">12</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">name</span>:<span class="string">"小红"</span>, <span class="attr">age</span>:<span class="number">11</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">name</span>:<span class="string">"小刚"</span>, <span class="attr">age</span>:<span class="number">15</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">name</span>:<span class="string">"小华"</span>, <span class="attr">age</span>:<span class="number">13</span> &#125;</span><br><span class="line">];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compare</span>(<span class="params">p</span>) </span>&#123; <span class="comment">//这是比较函数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">m, n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> a = m[p];</span><br><span class="line">        <span class="keyword">var</span> b = n[p];</span><br><span class="line">        <span class="keyword">return</span> a - b; <span class="comment">//升序</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">arr.sort(compares(<span class="string">"age"</span>));</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br></pre></td></tr></table></figure></p>
<p>然后我笑了，在评论区默默地留下了compares函数的简版：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compare = <span class="function"><span class="params">p</span> =&gt;</span> (m, n) =&gt; m[p] - n[p]</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>思考    </p>
</blockquote>
<p>Coding这么多年，其实大部分时间是比较麻木的，不走脑子的reading、copy以及coding，糊弄完了一个又一个项目。随着时光的飞逝，真正有意义的东西很少能留下来，所谓很少，其实还是有的，要不真该转行了，就比如这个ES6简写的过程，就是非常有趣并且优美的。但是这个过程很偶然，首先，你得初步了解过这个技术，然后，在一个被动的机会下，你静下心来，认真的体会技术带来的愉悦感，并真正的掌握这项技能。这似乎需要一个积累的过程，大量阅读以后再反复推敲，然后在这个过程中，自我成长，体会技术的真谛，并且使自己快乐！</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/23/光学字符识别引擎tesseract-ocr入门教程—Mac标注-Ubuntu打包/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fwind">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fwind's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/23/光学字符识别引擎tesseract-ocr入门教程—Mac标注-Ubuntu打包/" itemprop="url">光学字符识别引擎tesseract-ocr入门教程—Mac标注+Ubuntu打包</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-23T16:38:28+08:00">
                2019-08-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><blockquote>
<p>Tesseract是一个光学字符识别引擎，支持多种操作系统。Tesseract是基于Apache许可证的自由软件，自2006 年起由Google赞助开发。 2006年，Tesseract被认为是最精准的开源光学字符识别引擎之一。【维基百科】  </p>
</blockquote>
<h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><p>在使用tesseract-ocr的过程中，我遇到了一些问题，并找到了一种适合我的使用方式，在这里给大家分享一下。</p>
<h3 id="困境"><a href="#困境" class="headerlink" title="困境"></a>困境</h3><ol>
<li>在Mac下使用Homebrew安装tesseract-ocr时，—with-training-tools参数取消，所以无法训练数据；如果使用github下载源码，然后编译安装的话，需要安装很多依赖，比较麻烦；</li>
<li>如果在ubuntu下使用apt-get安装，默认是携带各种训练工具的，但是我的ubuntu系统是server版，不支持桌面，所以在标注图片时很不方便。<h3 id="我的解决方案"><a href="#我的解决方案" class="headerlink" title="我的解决方案"></a>我的解决方案</h3>我的解决方案是：在MacOS下标注，然后把标注好的box文件送到Ubuntu Server下，打包训练语言模型。<br>注意：如果您满足我在上文中提到的困境，就可以继续往下读了。</li>
</ol>
<h3 id="其他方案"><a href="#其他方案" class="headerlink" title="其他方案"></a>其他方案</h3><ol>
<li>在Mac下编译tesseract，使用jTessBoxEditor标注+训练</li>
<li>在Linux桌面版安装tesseract，使用jTessBoxEditor标注+训练</li>
<li>在Windows安装tesseract，使用jTessBoxEditor标注+训练</li>
</ol>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>tesseract-ocr支持Linux、Windows、MacOS、Android、IOS等操作系统。由于本人使用的操作系统是MacOS和Linux ubuntu server，所以本文只介绍这两个环境的安装。</p>
<h3 id="Mac"><a href="#Mac" class="headerlink" title="Mac"></a>Mac</h3><p>借助Homebrew，执行命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install tesseract-ocr</span><br></pre></td></tr></table></figure></p>
<p>安装完以后，截至今天为止，默认是4.0.0版本，不支持—with-training-tools，所以也不支持训练功能。如果直接使用github下载源码编译安装，是可以支持的，但是我比较懒，在需要训练操作时，我就去Linux上搞了（Linux的4.0.0是携带辅助训练工具包的）。</p>
<h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><p>借助apt-get，执行命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install tesseract-ocr</span><br></pre></td></tr></table></figure></p>
<h2 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h2><ol>
<li><p>设置识别语言，默认英文（eng），中文是chi_sim（需另行下载语言包），如果需要同时识别两种或者两种以上语言，比如同时识别中文和英文，格式为“-l chi_sim+eng”，执行以下命令，识别结果会以txt文本形式保存在目标路径下。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tesseract [待识别图片路径] [目标识别结果路径] -l eng</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置文字坐标输出，执行以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tesseract [待识别图片路径] [目标识别结果路径] -l <span class="built_in">test</span> makebox</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>识别结果会以box后缀文件形式保存在目标路径下，坐标内容包含识别结果左上角的横纵坐标以及长宽值，比如识别如下字符：<br><img src="train000.jpeg" alt><br>其结果为（啧啧啧，通用中文库识别效果很差）：<br><img src="CE4BA33A-2FC7-4D6B-85FA-6FD5F92014E3.png" alt></p>
<h2 id="数据训练"><a href="#数据训练" class="headerlink" title="数据训练"></a>数据训练</h2><h3 id="借助第三方工具"><a href="#借助第三方工具" class="headerlink" title="借助第三方工具"></a>借助第三方工具</h3><p>jTessBoxEditor是一款辅助标记的工具，在本地安装完tesseract-ocr以后，可以在jTessBoxEditor中配置tesseract-ocr的启动路径，然后基于tesseract-ocr进行可视化标注。如下图所示：<br><img src="582990A8-6E55-46D2-93D2-3D12AEFB8412.png" alt></p>
<h4 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h4><p>在jTessBoxEditor的Trainer标签下，主要功能说明：</p>
<ol>
<li>Tesseract Executables配置tesseract程序启动路径</li>
<li>Training Data存放训练数据路径</li>
<li>Language为自定义训练集名称</li>
<li>Bootstrap Language是训练之前需要借助的语言模型名称</li>
<li>然后选择Make Box File Only<br>注意：使用jTessBoxEditor需要配置Java环境变量。</li>
</ol>
<h4 id="初步识别"><a href="#初步识别" class="headerlink" title="初步识别"></a>初步识别</h4><ol>
<li>选择Make Box File Only</li>
<li>点击run按钮，就可以出来借助默认语言模型执行的识别结果。</li>
</ol>
<h4 id="开始标注"><a href="#开始标注" class="headerlink" title="开始标注"></a>开始标注</h4><p>在获取到执行结果以后，切换到Box Editor标签，如下图所示：<br><img src="6938E61D-E2CD-4DAF-9C73-F9DE8AAA2246.png" alt><br>标注过程：</p>
<ol>
<li>首先点击“open”按钮打，打开之前识别结果box</li>
<li>在左侧列表中，选择一个字符，比如上图中手写版的“测”字，然后在右侧提示框中对其进行调整，直到红色框完美包含字符</li>
<li>然后依次调整其余所有字符</li>
<li>如果需要新增标注框，点击“insert”，或者需要删除，请点击“delete”</li>
<li>如何需要合并两个字符，点击“merge”，或者均分字符，请点击“split”</li>
<li>点击“save”保存box</li>
<li>返回上个标签Trainer，然后选择“Train with Existing Box”，点击“run”执行</li>
<li>这时会在训练路径下生存.traindate语言模型</li>
<li>最后，再换一张与训练数据类似的图片，点击Validate进行验证。<br>注意：如果你没有在Mac上编译安装tesseract，只是通过brew安装了4.x.x版本，那么到第6步就可以停止了，因为该版本不携带训练工具，你可以拿着标注好的box文件，找一个linux机器手动生存语言模型包，过程参考上述“命令行打包语言模型”。</li>
</ol>
<h3 id="命令行打包语言模型"><a href="#命令行打包语言模型" class="headerlink" title="命令行打包语言模型"></a>命令行打包语言模型</h3><ol>
<li>使用tesseract命令生成识别结果box文件</li>
<li>调整box（或者直接使用jTessBoxEditor标注结果）</li>
<li><p>依次执行以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># picture.jpeg是待识别图片</span></span><br><span class="line">tesseract picture.jpeg picture nobatch box.train</span><br><span class="line">unicharset_extractor picture.box</span><br><span class="line"><span class="comment"># 新建font_properties本文，内容为test 0 0 0 0 0</span></span><br><span class="line">shapeclustering -F font_properties -U unicharset picture.tr </span><br><span class="line">mftraining -F font_properties -U unicharset -O unicharset picture.tr </span><br><span class="line">cntraining picture.tr </span><br><span class="line"><span class="comment"># 到此为止，会生成unicharset、inttemp、pffmtable、shapetable、normproto等五个文件，分别给他们加上test.前缀（test为自定义语言模型名称）</span></span><br><span class="line">combine_tessdata <span class="built_in">test</span>.</span><br></pre></td></tr></table></figure>
</li>
<li><p>此时会在当前目录下生成test.traineddata文件，移动该文件到tesseract-ocr的tesedata目录下（我的路径是_usr_share_tesseract-ocr/4.00_tessdata/）</p>
</li>
<li><p>然后设置语言执行识别命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># test是刚才生成的语言模型名称</span></span><br><span class="line">tesseract test1.jpeg test1 -l <span class="built_in">test</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>执行结果：（效果还是不错的）<br><img src="0FB5D384-F43A-4890-9E24-505A65475F79.png" alt><br><img src="744B0A5C-67AB-41C3-A582-1EAE41CF9CFA.png" alt></p>
</li>
</ol>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>总体而言，虽然是桌面版标注+服务器端处理，但是使用起来还是可以接受的。如果将来有时间，可以研究一下在mac下之间编译tesseract源码</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/03/pm2学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fwind">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fwind's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/03/pm2学习笔记/" itemprop="url">pm2学习笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-03T13:14:17+08:00">
                2019-07-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="pm2学习笔记.jpg" alt></p>
<h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>PM2（process manage）是JavaScript运行时Node.js的进程管理器。</p>
<h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 借助npm包管理器安装</span></span><br><span class="line">npm install -g pm2</span><br></pre></td></tr></table></figure>
<h3 id="启动进程"><a href="#启动进程" class="headerlink" title="启动进程"></a>启动进程</h3><h4 id="命令行启动"><a href="#命令行启动" class="headerlink" title="命令行启动"></a>命令行启动</h4><ol>
<li><p>默认启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动一个nodejs进程，进程名默认为nodejs文件名，默认为fork单进程模式</span></span><br><span class="line">pm2 start app.js</span><br></pre></td></tr></table></figure>
</li>
<li><p>自定义启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动并自定义进程名</span></span><br><span class="line">pm2 start app.js --name processNames</span><br></pre></td></tr></table></figure>
</li>
<li><p>负载均衡</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 负载均衡（服务器只是满足双核及以上），max为默认最大cpu数，可以自定义</span></span><br><span class="line">pm2 start app.js -i max</span><br></pre></td></tr></table></figure>
</li>
<li><p>目录监听</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 监听目录变化，默认不启动</span></span><br><span class="line">pm2 start app.js --watch</span><br></pre></td></tr></table></figure>
</li>
<li><p>携带参数启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 携带<span class="built_in">test</span>和100启动进程</span></span><br><span class="line">pm2 start app.js -- -test -100</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="配置启动脚本"><a href="#配置启动脚本" class="headerlink" title="配置启动脚本"></a>配置启动脚本</h4><ol>
<li><p>首先，编辑启动脚本内容</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"apps"</span>: [&#123;</span><br><span class="line">        <span class="attr">"name"</span>: <span class="string">"app1"</span>,</span><br><span class="line">        <span class="attr">"script"</span>: <span class="string">"./app1.js"</span>,</span><br><span class="line">        <span class="attr">"watch"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">        <span class="attr">"name"</span>: <span class="string">"app2"</span>,</span><br><span class="line">        <span class="attr">"script"</span>: <span class="string">"./app1.js"</span>,</span><br><span class="line">        <span class="attr">"watch"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>然后执行启动命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm2 start app.json</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="重启进程"><a href="#重启进程" class="headerlink" title="重启进程"></a>重启进程</h3><ol>
<li>重启/更新单个进程<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重启0进程</span></span><br><span class="line">pm2 restart 0</span><br><span class="line"><span class="comment"># 更新0进程</span></span><br><span class="line">pm2 reload 0</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>区别：重启的过程是先停止（stop）进程，然后再开启（start）进程，可能会造成已建立连接的实效；更新的过程是先开启（start）一个或者若干进程，同时停止旧的进程接收请求，然后旧的进程结束以后，再关闭旧的进程。</p>
<ol start="2">
<li><p>重启/更新所有进程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重启所有进程</span></span><br><span class="line">pm2 restart all</span><br><span class="line"><span class="comment"># 更新所欲进程</span></span><br><span class="line">pm2 reload all</span><br></pre></td></tr></table></figure>
</li>
<li><p>优雅的更新一个/所有进程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 优雅的重启0进程</span></span><br><span class="line">pm2 gracefulReload 0</span><br><span class="line"><span class="comment"># 优雅的重启所有进程</span></span><br><span class="line">pm2 gracefulReload all</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>备注：gracefulReload区别于reload的地方在于，会发送一个shutdown的消息给旧的进程，这个过程可以在程序中监听到，然后根据自己的业务逻辑进程处理。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这里我们可以监听到‘shutdown’，然后在里面可以自定义一些跟自己项目相关的业务逻辑</span></span><br><span class="line">process.on(<span class="string">'shutdown'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    server.close();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="进程日志"><a href="#进程日志" class="headerlink" title="进程日志"></a>进程日志</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 实时查阅进程0的日志</span></span><br><span class="line">pm2 <span class="built_in">log</span> 0</span><br><span class="line"><span class="comment"># 查阅所有进程的日志</span></span><br><span class="line">pm2 logs</span><br></pre></td></tr></table></figure>
<h3 id="停止进程"><a href="#停止进程" class="headerlink" title="停止进程"></a>停止进程</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 停止0进程</span></span><br><span class="line">pm2 stop 0</span><br><span class="line"><span class="comment"># 停止所有进程</span></span><br><span class="line">pm2 stop all</span><br></pre></td></tr></table></figure>
<h3 id="删除进程"><a href="#删除进程" class="headerlink" title="删除进程"></a>删除进程</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除0进程</span></span><br><span class="line">pm2 delete 0</span><br><span class="line"><span class="comment"># 删除所有进程</span></span><br><span class="line">pm2 delete all</span><br></pre></td></tr></table></figure>
<h3 id="进程列表"><a href="#进程列表" class="headerlink" title="进程列表"></a>进程列表</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看进程状态</span></span><br><span class="line">pm2 list</span><br></pre></td></tr></table></figure>
<p><img src="list.png" alt></p>
<h3 id="进程监控"><a href="#进程监控" class="headerlink" title="进程监控"></a>进程监控</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 监控所有进程的实施状态</span></span><br><span class="line">pm2 monit</span><br></pre></td></tr></table></figure>
<p><img src="monit.png" alt></p>
<h3 id="保存配置"><a href="#保存配置" class="headerlink" title="保存配置"></a>保存配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 保存当前所有进程任务</span></span><br><span class="line">pm2 save</span><br></pre></td></tr></table></figure>
<h3 id="还原配置"><a href="#还原配置" class="headerlink" title="还原配置"></a>还原配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 还原最后一个保存的所有进程任务</span></span><br><span class="line">pm2 resurrect</span><br></pre></td></tr></table></figure>
<h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><h3 id="守护进程"><a href="#守护进程" class="headerlink" title="守护进程"></a>守护进程</h3><p>当进程出现崩溃、异常停止等现象时，pm2会帮你重启该进程。</p>
<h3 id="进程监控-1"><a href="#进程监控-1" class="headerlink" title="进程监控"></a>进程监控</h3><p>实时查看进程的cpu、内存占有情况以及运行状态等。</p>
<h3 id="日志管理"><a href="#日志管理" class="headerlink" title="日志管理"></a>日志管理</h3><p>所有pm2日志会默认保存在～/.pm2/logs目录下，以进程名命名生成相应的日志文件，可以借助pm2-logrotate模块实现日志的按时间或者大小切割，便于归档记录，排查故障。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/28/tmux学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fwind">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fwind's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/28/tmux学习笔记/" itemprop="url">tmux学习笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-28T11:14:17+08:00">
                2019-06-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="tmux学习笔记.jpg" alt></p>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>Tmux 是一个优秀的终端复用器类自由软件，但使用 BSD 许可发布。用户可以通过 tmux 在一个终端内管理多个分离的会话，窗口及面板，对于同时使用多个命令行，或多个任务时非常方便。</p>
<h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><h3 id="会话"><a href="#会话" class="headerlink" title="会话"></a>会话</h3><ol>
<li><p>新建会话</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 新建会话，会话名默认生成</span></span><br><span class="line">tmux</span><br><span class="line"><span class="meta">#</span><span class="bash"> 新建会话，并声明会话名</span></span><br><span class="line">tmux new -s session_name</span><br></pre></td></tr></table></figure>
</li>
<li><p>正在运行会话列表查阅</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmux ls</span><br></pre></td></tr></table></figure>
</li>
<li><p>打开一个正在运行会话</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmux a -t session_name</span><br></pre></td></tr></table></figure>
</li>
<li><p>退出当前会话<br>快捷键：control+b，d</p>
</li>
<li>删除会话<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 删除一个正在运行的会话</span></span><br><span class="line">tmux kill-session -t session_name</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除当前会话名以外的其余会话（不指定会话名，默认保留第一条会话）</span></span><br><span class="line">tmux kill-session -a -t session_name</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="分屏"><a href="#分屏" class="headerlink" title="分屏"></a>分屏</h3><ol>
<li>横向分屏<br>快捷键：control+b，%</li>
<li>纵向分屏<br>快捷键：control+b，”</li>
</ol>
<h3 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h3><ol>
<li>移动光标<br>快捷键：control+b，方向键</li>
<li>显示系统时间<br>快捷键：control+b，t</li>
<li>关闭窗口<br>在当前会话下，将光标移动到待关闭窗口，然后敲命令exit即可关闭窗口。</li>
</ol>
<h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><h3 id="代码调试"><a href="#代码调试" class="headerlink" title="代码调试"></a>代码调试</h3><p>在Linux或者Mac终端水平或者垂直切割屏幕，将切割区域分为代码部分、编译部分、调试效果展示部分、日志记录部分等，当我们需要debug时：在代码部分敲入代码，然后在代码编译部分编译代码，最后在展示部分（可终端展示程序）查看效果，如果有问题呢，在日志部分也可以实时检查。可谓码农的编程利器啊！</p>
<h3 id="系统监控"><a href="#系统监控" class="headerlink" title="系统监控"></a>系统监控</h3><p>我们可以建立多个会话，分别监控我们需要关注的系统性能、报警等信息，比如cpu使用情况、网络使用情况、内存是否正常、磁盘是否够用等等，然后在每个会话里，我们还可以通过屏幕切割达到对于每项监控更加细致的分类，一目了然，掌控全局！</p>
<h3 id="记忆标签"><a href="#记忆标签" class="headerlink" title="记忆标签"></a>记忆标签</h3><h4 id="本地"><a href="#本地" class="headerlink" title="本地"></a>本地</h4><p>很多使用Mac的同学都一个不成文的习惯，电脑长时间不关机，并且同时开启很多终端，原因有很多，比如担心重启电脑以后丢失之前进行到一半的任务，或则只是因为懒……当然，mac本身设计的很好，就算长期不重启也毫无压力。这个时候，其实我们需要一个记忆标签工具，来管理我们打开的数量庞大的终端们。不管开启多少个终端，只要我们简单的取个名字作为标记，下次再找的时候会快捷很多！</p>
<h4 id="服务器"><a href="#服务器" class="headerlink" title="服务器"></a>服务器</h4><p>对于服务器来说，重启的机会更加微乎其微，这个时候，我们就更需要一个终端记忆标签工具来管理我们的远程会话了，当我们ssh连接服务器时，遇到突发事件，比如被叫去开会，或者下班了，没关系！在开完会或者第二天上班以后，我们还可以进入当时那个会话，继续之前没有完成的工作。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/24/ssh学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fwind">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fwind's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/24/ssh学习笔记/" itemprop="url">ssh学习笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-24T10:18:40+08:00">
                2019-06-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="ssh学习笔记.jpg" alt></p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>Secure Shell（安全外壳协议，简称SSH）是一种加密的网络传输协议，可在不安全的网络中为网络服务提供安全的传输环境。</p>
<h2 id="连接方式"><a href="#连接方式" class="headerlink" title="连接方式"></a>连接方式</h2><h3 id="秘密验证"><a href="#秘密验证" class="headerlink" title="秘密验证"></a>秘密验证</h3><p>连接命令：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh username@ip</span><br></pre></td></tr></table></figure></p>
<p>注释：其中username是服务器的用户名，ip是服务器的地址，然后输入服务器端该用户的登录密码即可完成连接验证。</p>
<h3 id="密钥验证"><a href="#密钥验证" class="headerlink" title="密钥验证"></a>密钥验证</h3><ol>
<li>生成密钥<br>在客户端生成公钥和私钥，此处我们使用rsa作为加密方式（加密方式另外还有rsa1、ecdsa、ed25519、dsa等），使用以下命令生成密钥：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>并设置文件名和秘密（这里我们定义文件名为id_rsa），然后会在目录~<em>.ssh</em>下生成私钥文件id_rsa和公钥文件id_rsa.pub。</p>
<ol start="2">
<li>连接验证<br>生成密钥文件以后，将公钥放置在服务器端的目录~_.ssh_authorized_keys下，然后在客户端使用私钥进行免秘密验证，连接命令：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -i ~/.ssh/id_rsa username@ip</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="快速连接配置"><a href="#快速连接配置" class="headerlink" title="快速连接配置"></a>快速连接配置</h2><p>在文件目录~<em>.ssh</em>下有个config文件，我们可以将上文两种连接方式中写在里面，然后直接以ssh+服务器简称的方式进行快速连接。</p>
<ol>
<li>秘密配置<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Host    server01</span><br><span class="line">    HostName        192.168.1.10</span><br><span class="line">    Port            22</span><br><span class="line">    User            username</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>注释：22是ssh的默认连接端口（可变更）。配置完成以后，可以通过以下命令连接，连接时需要再次输入密码。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh server01</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>密钥配置<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Host    server02</span><br><span class="line">    HostName        192.168.1.11</span><br><span class="line">    Port            22</span><br><span class="line">    User            username</span><br><span class="line">    IdentityFile    ~/.ssh/id_rsa</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>注释：其中IdentityFile为私钥文件的路径。配置完成以后，可以通过以下命令连接，连接时无需再次输入密码。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh server02</span><br></pre></td></tr></table></figure></p>
<h2 id="搭建通道"><a href="#搭建通道" class="headerlink" title="搭建通道"></a>搭建通道</h2><p>最简单的文件复制通道，执行命令：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -i ~/.ssh/id_rsa '待传送文件' username@ip:'目标传送目录'</span><br></pre></td></tr></table></figure></p>
<p>通过以上命令，可以建立客户机和服务器之间或者两台服务器之间，文件单向传送的通道。</p>
<h2 id="安全性"><a href="#安全性" class="headerlink" title="安全性"></a>安全性</h2><p>SSH旨在保证非安全网络环境（例如互联网）中信息加密完整可靠。不过，SSH它也被指出有被嗅探甚至解密的漏洞。这里我们就不做具体介绍了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/28/linux下root用户连接ssh/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="fwind">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fwind's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/28/linux下root用户连接ssh/" itemprop="url">linux下root用户连接ssh</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-05-28T09:11:36+08:00">
                2019-05-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>linux，ubuntu，root，xshell，ssh</p>
</blockquote>
<ul>
<li>启用root用户</li>
</ul>
<ol>
<li>配置过程 <pre><code>[workspace]@username:~$ sudo passwd root
[sudo] password for fwind: 
Enter new UNIX password: 
Retype new UNIX password: 
passwd: password updated successfully
workspace@username:~$ reboot
</code></pre></li>
<li>完成<pre><code>root@username:~$
</code></pre></li>
</ol>
<ul>
<li>连接ssh</li>
</ul>
<ol>
<li>修改配置文件<br>使用<strong>root权限</strong>用户打开ssh配置文件：<pre><code>vim /etc/ssh/sshd_config
</code></pre>找到“<strong>PermitRootLogin prohibit-password</strong>”一行，将“prohibit-password”改为“yes”，然后重启ssh服务；</li>
<li>重启<br>在root下重启ssh服务，然后。。。就可以在xshell下使用ssh肆无忌惮的连接linux了。<pre><code>sudo service sshd restart
</code></pre></li>
</ol>
<p><strong>ps: vim 是linux下一款非常强大的编辑器，后续会有相关使用心得，敬请期待！</strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">fwind</p>
              <p class="site-description motion-element" itemprop="description">code</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fwind</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
